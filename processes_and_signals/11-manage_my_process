#!/usr/bin/env bash
# Manages "my process"

PID_FILE="/var/run/my_process.pid"
PROCESS_SCRIPT="/path/to/manage_my_process.sh"

case "$1" in
    start)
        if [ -f "$PID_FILE" ]; then
            echo "manage_my_process is already running"
            exit 1
        fi
        # Run the process in the background
        nohup bash "$PROCESS_SCRIPT" &> /dev/null &
        echo $! > "$PID_FILE"  # Save the PID to the PID file
        echo "manage_my_process started"
        ;;

    stop)
        if [ -f "$PID_FILE" ]; then
            # Kill the process and remove the PID file
            PID=$(cat "$PID_FILE")
            if kill "$PID" 2>/dev/null; then
                rm -f "$PID_FILE"  # Remove the PID file
                echo "manage_my_process stopped"
            else
                echo "Failed to stop manage_my_process (process may not exist)"
                exit 1
            fi
        else
            echo "manage_my_process is not running"
            exit 1
        fi
        ;;

    restart)
        $0 stop  # Stop the process
        $0 start  # Start the process
        echo "manage_my_process restarted"
        ;;

    *)
        echo "Usage: manage_my_process {start|stop|restart}"
        exit 1
        ;;
esac

